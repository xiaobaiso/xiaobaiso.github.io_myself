---
layout:     post
title:      临时邮的技术总览
category: blog

---

## 临时邮所用的技术

这是一个有前端有后台的项目，前端采用OC+Swift混编，后台用Python提供Api，同时使用Linux开源程序Postman做邮件接收器，这样就完成了最基本的技术选型。OC和Swift混编有助于学习这一块的相关知识，个人项目无需追求高并发和实时性，可以选择较为易用的Python，Postman是较为经典的邮件接收器，使用它可以较快的搭建邮件服务相关功能。

<img src="https://github.com/xiaobaiso/xiaobaiso.github.io/raw/master/image/临时邮/临时邮总体架构.png" style="zoom:50%" />
.


## 后台的具体配置

### 域名

可以从阿里云购买，需要至少两个域名，一个用于介绍做博客宣传使用，一个用于提供Api做请求用。事实上，临时邮这个还多用了一个域名，用于邮件的接收域名。域名与邮件服务器的绑定，以及域名生成Https证书，配合Nginx使用。这是一段很长的故事，可以慢慢讲。

### 后台服务器
采用的是阿里云的基本配置，由于使用的是Https协议流，所以并不消耗太多的带宽。临时邮采用了2M的带宽，服务器选用qemu架构的云主机，标的为华南地区(深圳)，故延时各方面有保障。如果要使用文件传输，也不会消耗太大的带宽。

由于是个人项目，所以不需要制作主备服务器或是主备数据库，仅仅一台服务器即可。




## 开发环境的说明

### 开发环境的建立

比如你有两个人开发一个项目，或者说要在有多个电脑上开发，你在A电脑上面写了一部分代码，在B上面怎么继续开发？

我建议使用Git来同步你的一切东西，包括文档，UI材料，甚至是你的思维导图。

这个问题我认为最好的办法就是使用Git来接管你的全部数据源，每次开发之前都与服务器进行一次同步，开发结束后再进行一次更新。这样你只要多个机器上面，都能获取最新的数据。我建议使用Github来做远端Git的数据同步器。

### 调试环境的建立

代码更新下来了，不代表程序能够运行起来，比如对应的后端库，这是不会被更新的。我建议是使用Python的virtualenv，这样只要把库安装到对应的虚拟环境中，就可以做到更新环境和更新代码一样简单。另外，把后端的安装与发布整合成一个脚本，对于多个环境也有帮助。

### 多启动环境的建立

目前程序包含三个环境

 - 本地开发-模拟器模式 
 - 本地开发-真机模式
 - 生产环境模式
 
模拟器模式是xcode运行模拟器，后台运行在本地，这种模式我起先用的很开心，但是真机调试多有不便，因为真机运行的本地和xcode运行的本地并不是一个本地。就是说，手机的127.0.0.1和服务端的127.0.0.1不是同一个。

正是因为有了上面这个问题，所以有了第二个环境，这个环境需要配合Chirles使用，将手机代理到抓包软件上，再定向到本地(抓包软件和server端在同一台机器上)。

## HTTPS证书
到阿里云上面去买，DV证书现在免费。绝对是比其他的免费证书好很多。而且DV证书从购买到分发下来只要十几分钟时间，全自动化审批。










